### C++预处理指令

---
```
#include <...> 文件包含指令
```

- 将所包含文件的内容粘贴到该指令处
  + <...> 尖括号包含 ······················ 先找 `-l` 目录, 再找系统目录 `/usr/include`, 适用于 <u>**系统头文件**</u>
  + "..." 双引号包含 ······················ 先找 `-l` 目录, 再找当前目录, 最后找系统目录 `/usr/include`, 适用于<u>**自己编写的头文件**</u>
- 命令: `gcc -E -o xxx.i xxx.c`


---
```
#define 宏名 (宏值) ·············· 无参数宏
#define 宏名(形参表) (宏值) ······ 有参数宏
```
- 预处理时会将程序里宏的名称, 替换为宏值
- *注意: 宏只是会在预处理阶段做一个 **文本替换***
  + 例如: `#define  PI  3.14`
  + 其中: `PI` 不具有任何数据类型
---
```
#undef
```
- 取消一个已定义的宏, 令其宏名处于***未定义***的状态
---
#### 预定义宏

***可以帮助我们快速定位到代码的问题所在***

|预定义宏|说明|
|:---:|:---:|
| `__FILE__`     | 所在文件名%s |
| `__LINE__`     | 所在行号%d   |
| `__FUNCTION__` | 所在函数名%s |
| `__func__`     | 同上         |
| `__DATE__`     | 编译日期%s   |
| `__TIME__`     | 编译时间%s   |

---
#### 条件编译指令
| 条件编译指令 | 说明 |
| :---: | :---: |
| `#if 常量表达式` | 如果常量表达式非零|
| `#ifdef 宏名` | 如果宏名已定义 |
| `#ifndef 宏名` | 如果宏名未定义 |
| `#elif 常量表达式` | 否则如果常量表达式的值非零 |
| `#else` | 否则 |
| `endif` | 结束判断|
| `常量表达式` | 字面值/defined(宏名)/&&/||/! | 

应用场景: 让一套代码适应于不同平台, 例如 Linux内核, 运行 x86, arm, PowerPC, mips...
```
cpu_init(void){
    // 和平台无关的代码
    ...  (90%);
    #if ARCH == x86
        x86_cpu 的初始化代码;
    #elif ARCH == arm
        arm_cpu 的初始化代码;
    #elif ARCH == mips
        mips_cpu 的初始化代码;
    ...
    #endif
}
```
要想单独生成适应于 arm平台的代码:`gcc -DARCH=arm xxx.c -o xxx `

---



